<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Dexterator Analysis Tool</title>
        <link rel="stylesheet" href="ai.css" />
        <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>
        <header>
            <div class="container">
                <h1>âš¡Analysis Tool</h1>
                <div class="controls">
                    <div class="control-group">
                        <label for="symbol-select">Symbol:</label>
                        <select id="symbol-select">
                            <option value="R_10">Volatility 10 index</option>
                            <option value="1HZ10V">Volatility 10 (1s) index</option>
                            <option value="R_25">Volatility 25 index</option>
                            <option value="1HZ25V">Volatility 25 (1s) index</option>
                            <option value="R_50">Volatility 50 index</option>
                            <option value="1HZ50V">Volatility 50 (1s) index</option>
                            <option value="R_75">Volatility 75 index</option>
                            <option value="1HZ75V">Volatility 75 (1s) index</option>
                            <option value="R_100">Volatility 100 index</option>
                            <option value="1HZ100V">Volatility 100 (1s) index</option>
                            <option value="JD10">Jump 10 Index</option>
                            <option value="JD25">Jump 25 Index</option>
                            <option value="JD50">Jump 50 Index</option>
                            <option value="JD100">Jump 100 Index</option>
                            <option value="RDBEAR">Bear Market Index</option>
                            <option value="RDBULL">Bull Market Index</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="tick-count-input">Tick Count:</label>
                        <input type="number" id="tick-count-input" value="1000" min="1" />
                    </div>
                    <div class="control-group">
                        <button id="theme-toggle" class="theme-toggle-btn">Dark Theme</button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="container">
                <section id="digit-display-section">
                    <p2 id="current-price">N/A</p2>
                    <!-- Added this line -->
                    <h2>Digit Display</h2>
                    <div id="digit-display-container"></div>
                </section>
                <section id="last-50-oe">
                    <h2>Odd/Even Analysis</h2>
                    <div id="last-50-oe-container"></div>
                </section>

                <section id="even-odd-chart-section">
                    <p1 id="even-odd-percentage">Even: N/A% Odd: N/A%</p1>
                    <canvas id="even-odd-chart"></canvas>
                </section>
                <section id="rise-fall-chart-section">
                    <h2>Rise/Fall Analysis</h2>
                    <p1 id="rise-fall-percentage">Rise: N/A% Fall: N/A%</p1>
                    <canvas id="rise-fall-chart"></canvas>
                </section>
                <section id="digit-chart-section">
                    <h2>Digit Distribution</h2>
                    <p1 id="digit-percentage">Highest: N/A% Lowest: N/A%</p1>
                    <canvas id="digit-chart"></canvas>
                </section>
                <!-- Add this inside <main> at the bottom, before </div> -->
                <section id="tick-chart-section">
                    <h2>Live Tick Chart</h2>
                    <canvas id="tickChartCanvas" width="600" height="300"></canvas>
                </section>

                <!-- Data Sync & Integrity Controls -->
                <section id="data-sync-section" style="margin-top: 2em">
                    <h2>Data Synchronization & Integrity</h2>
                    <div id="sync-status" style="margin-bottom: 0.5em; color: #555; font-size: 0.98em"></div>
                    <button onclick="backfillGaps()">Detect & Backfill Gaps</button>
                    <button onclick="compareWithRestApi()">Compare with REST API</button>
                    <div id="diff-results" style="margin-top: 1em"></div>
                </section>
            </div>
        </main>
        <!-- Styles moved to ai.css -->
        <script src="ai.js"></script>
        <script>
            // Theme Toggle Functionality
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;

            // Load saved theme or default to navy
            const savedTheme = localStorage.getItem('theme') || 'navy';
            body.setAttribute('data-theme', savedTheme);
            updateToggleButton(savedTheme);

            themeToggle.addEventListener('click', () => {
                const currentTheme = body.getAttribute('data-theme');
                const newTheme = currentTheme === 'navy' ? 'light' : 'navy';

                body.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateToggleButton(newTheme);
            });

            function updateToggleButton(theme) {
                if (theme === 'navy') {
                    themeToggle.textContent = 'Dark Navy';
                    themeToggle.title = 'Switch to Light Theme';
                } else {
                    themeToggle.textContent = 'Light Blue';
                    themeToggle.title = 'Switch to Navy Theme';
                }
            }
        </script>
    </body>
</html>
